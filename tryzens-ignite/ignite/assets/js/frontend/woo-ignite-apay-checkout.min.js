!function(e,t){function o(){t.Gateway.call(this),this.check_device_callback_handler(),this.check_device(),this.bind_updated_checkout_event(),"0"!==woo_ignite_apay_obj.admin_checkout_order_id&&this.bind_payment_method_selected_event()}o.prototype=e.extend({},t.Gateway.prototype),o.prototype.hide_place_order_button=function(t){woo_ignite_apay_obj.id===this.selected_gateway()&&e("#place_order").hide()},o.prototype.check_device=function(){e(document.body).on("updated_checkout",this.check_device_callback_handler.bind(this))},o.prototype.check_device_callback_handler=function(e){var t=document.querySelector('input[value="'+woo_ignite_apay_obj.id+'"]');if(t){var o=t.closest("li");o&&(window.ApplePaySession?o.style.display="show":o.style.display="none")}},o.prototype.bind_payment_method_selected_event_handler=function(t){e("#place_order").show(),e("#"+woo_ignite_apay_obj.id+"_widget").empty(),woo_ignite_apay_obj.id===this.selected_gateway()&&(null!=t&&t.stopImmediatePropagation(),this.ajax_call(woo_ignite_apay_obj))},o.prototype.bind_success_ajax_handler=function(t){try{if((t=JSON.parse(t)).transactionId){this.hide_place_order_button(),e("#"+woo_ignite_apay_obj.id+"_transactionId").remove();let i="";i="0"!==woo_ignite_apay_obj.admin_checkout_order_id?"#order_review":"form.checkout",e("<input>").attr({type:"hidden",id:woo_ignite_apay_obj.id+"_transactionId",name:woo_ignite_apay_obj.id+"_transactionId",value:t.transactionId}).appendTo(i);const a=this.ignite_obj_creation(t.transactionId),_=new window.IgnitePayment(a);_.setStyle({height:"470px",width:"75%"}),e("#"+woo_ignite_apay_obj.id+"_widget").html(""),_.apm(woo_ignite_apay_obj.id+"_widget","apple-pay");const n=this.message_events();_.messageEventHandler(n),o.prototype.ignite_widget=_}else this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}catch(e){this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}},o.prototype.error_handler=function(t){e("#"+woo_ignite_apay_obj.id+"_error").remove(),e("#"+woo_ignite_apay_obj.id+"_widget").prepend('<div class="woocommerce-error" id="'+woo_ignite_apay_obj.id+'_error">'+t+"</div>")},o.prototype.ignite_obj_creation=function(e){return{clientID:woo_ignite_apay_obj.key,clientKey:woo_ignite_apay_obj.publishable_key,tokenize:!1,transactionId:e}},o.prototype.message_events=function(){let t="";return t="0"!==woo_ignite_apay_obj.admin_checkout_order_id?"#order_review":"form.checkout",{onSubmit:()=>{},onSuccess:async o=>{woo_ignite_apay_obj.id===this.selected_gateway()&&e(t).submit()},onFailure:async()=>{woo_ignite_apay_obj.id===this.selected_gateway()&&e(t).submit()}}},e(document).ready((function(){new o}))}(jQuery,window.ignite);