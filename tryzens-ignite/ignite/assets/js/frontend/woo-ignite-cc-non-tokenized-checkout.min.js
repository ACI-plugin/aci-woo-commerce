!function(e,o){function n(){(o.Gateway.call(this),this.bind_click_place_order_event(),this.bind_update_checkout_event(),this.bind_updated_checkout_event(),"0"!==woo_ignite_cc_non_tokenized_obj.admin_checkout_order_id)&&(this.bind_payment_method_selected_event(),e(".wc_payment_method.payment_method_"+woo_ignite_cc_non_tokenized_obj.id+" ul.woocommerce-SavedPaymentMethods").each((function(){e(this).wc_tokenization_form()})));e(document.body).on("change","input[id^=wc-"+woo_ignite_cc_non_tokenized_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput:checked",this.bind_change_saved_payment_methods_event_handler.bind(this))}n.prototype=e.extend({},o.Gateway.prototype),n.prototype.bind_update_checkout_event_handler=function(){e("[data-css-class$='widget_class']").each((function(){e(this).removeClass(e(this).attr("data-css-class"))}))},n.prototype.bind_change_saved_payment_methods_event_handler=function(o){if(this.selected_gateway()===woo_ignite_cc_non_tokenized_obj.id){let n="";if("new"==e(o.currentTarget).val()?(woo_ignite_cc_non_tokenized_obj.tokenId="",n=".woocommerce-SavedPaymentMethods-new"):(woo_ignite_cc_non_tokenized_obj.tokenId=woo_ignite_cc_non_tokenized_obj.token_id[e(o.currentTarget).val()],n=".woocommerce-SavedPaymentMethods-token"),!e(o.currentTarget).closest(n).find("#"+woo_ignite_cc_non_tokenized_obj.id+"_widget"+woo_ignite_cc_non_tokenized_obj.tokenId+"."+woo_ignite_cc_non_tokenized_obj.id+"widget_class").length){e(".wc_payment_method.payment_method_"+woo_ignite_cc_non_tokenized_obj.id+" [data-css-class$='widget_class']").each((function(){e(this).remove()}));const t='<div id="'+woo_ignite_cc_non_tokenized_obj.id+"_widget"+woo_ignite_cc_non_tokenized_obj.tokenId+'" class="'+woo_ignite_cc_non_tokenized_obj.id+'widget_class" data-css-class="'+woo_ignite_cc_non_tokenized_obj.id+'widget_class"></div>';e(o.currentTarget).closest(n).append(t),this.ajax_call(woo_ignite_cc_non_tokenized_obj)}}},n.prototype.bind_click_place_order_event_handler=function(e){this.selected_gateway()===woo_ignite_cc_non_tokenized_obj.id&&(e.preventDefault(),this.ignite_widget.submit())},n.prototype.bind_payment_method_selected_event_handler=function(o){e("#place_order").show(),this.bind_update_checkout_event_handler(),this.selected_gateway()===woo_ignite_cc_non_tokenized_obj.id&&(e("input[id^=wc-"+woo_ignite_cc_non_tokenized_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput").length<=1?(this.ajax_call(woo_ignite_cc_non_tokenized_obj),null!=o&&o.stopImmediatePropagation()):null!=o&&(e("input[id^=wc-"+woo_ignite_cc_non_tokenized_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput:checked").trigger("change"),o.stopImmediatePropagation()))},n.prototype.bind_success_ajax_handler=function(o){try{if((o=JSON.parse(o)).transactionId){const t=this.ignite_obj_creation(o.transactionId),_=new window.IgnitePayment(t);if(""===woo_ignite_cc_non_tokenized_obj.tokenId){e("#"+woo_ignite_cc_non_tokenized_obj.id+"_token").remove();let n="";n="0"!==woo_ignite_cc_non_tokenized_obj.admin_checkout_order_id?"#order_review":"form.checkout",e("<input>").attr({type:"hidden",id:woo_ignite_cc_non_tokenized_obj.id+"_token",name:woo_ignite_cc_non_tokenized_obj.id+"_token",value:o.transactionId}).appendTo(n),_.setStyle({height:"470px",width:"75%"}),e("#"+woo_ignite_cc_non_tokenized_obj.id+"_widget").html(""),_.render(woo_ignite_cc_non_tokenized_obj.id+"_widget")}else _.setStyle({height:"270px",width:"75%"}),e("#"+woo_ignite_cc_non_tokenized_obj.id+"_widget"+woo_ignite_cc_non_tokenized_obj.tokenId).html(""),_.render(woo_ignite_cc_non_tokenized_obj.id+"_widget"+woo_ignite_cc_non_tokenized_obj.tokenId);const i=this.message_events();_.messageEventHandler(i),n.prototype.ignite_widget=_}else this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}catch(e){this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}},n.prototype.error_handler=function(o){e("#"+woo_ignite_cc_non_tokenized_obj.id+"_error").remove(),""===woo_ignite_cc_non_tokenized_obj.tokenId?e("#"+woo_ignite_cc_non_tokenized_obj.id+"_widget").prepend('<div class="woocommerce-error" id="'+woo_ignite_cc_non_tokenized_obj.id+'_error">'+o+"</div>"):e("#"+woo_ignite_cc_non_tokenized_obj.id+"_widget"+woo_ignite_cc_non_tokenized_obj.tokenId).prepend('<div class="woocommerce-error" id="'+woo_ignite_cc_non_tokenized_obj.id+'_error">'+o+"</div>")},n.prototype.ignite_obj_creation=function(e){return{clientID:woo_ignite_cc_non_tokenized_obj.key,clientKey:woo_ignite_cc_non_tokenized_obj.publishable_key,tokenize:!1,transactionId:e,tokenId:woo_ignite_cc_non_tokenized_obj.tokenId,showSavedCardOption:"1"===woo_ignite_cc_non_tokenized_obj.show_saved_card_option&&""===woo_ignite_cc_non_tokenized_obj.tokenId}},n.prototype.message_events=function(){return{onSubmit:()=>{},onSuccess:async o=>{if(woo_ignite_cc_non_tokenized_obj.id===this.selected_gateway()){let n="";n="0"!==woo_ignite_cc_non_tokenized_obj.admin_checkout_order_id?"#order_review":"form.checkout",""!==woo_ignite_cc_non_tokenized_obj.tokenId&&o.transactionId&&(e("#"+woo_ignite_cc_non_tokenized_obj.id+"_token").remove(),e("<input>").attr({type:"hidden",id:woo_ignite_cc_non_tokenized_obj.id+"_token",name:woo_ignite_cc_non_tokenized_obj.id+"_token",value:o.transactionId}).appendTo(n)),e(n).submit()}},onFailure:async()=>{}}},e(document).ready((function(){new n}))}(jQuery,window.ignite);