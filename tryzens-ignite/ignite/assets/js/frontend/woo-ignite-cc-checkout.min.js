!function(e,o){function t(){(o.Gateway.call(this),this.bind_click_place_order_event(),this.bind_update_checkout_event(),this.bind_updated_checkout_event(),"0"!==woo_ignite_cc_obj.admin_checkout_order_id)&&(this.bind_payment_method_selected_event(),e(".wc_payment_method.payment_method_"+woo_ignite_cc_obj.id+" ul.woocommerce-SavedPaymentMethods").each((function(){e(this).wc_tokenization_form()})));e(document.body).on("change","input[id^=wc-"+woo_ignite_cc_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput:checked",this.bind_change_saved_payment_methods_event_handler.bind(this))}t.prototype=e.extend({},o.Gateway.prototype),t.prototype.bind_update_checkout_event_handler=function(){e("[data-css-class$='widget_class']").each((function(){e(this).removeClass(e(this).attr("data-css-class"))}))},t.prototype.bind_change_saved_payment_methods_event_handler=function(o){if(this.selected_gateway()===woo_ignite_cc_obj.id){let t="";if("new"==e(o.currentTarget).val()?(woo_ignite_cc_obj.tokenId="",t=".woocommerce-SavedPaymentMethods-new"):(woo_ignite_cc_obj.tokenId=woo_ignite_cc_obj.token_id[e(o.currentTarget).val()],t=".woocommerce-SavedPaymentMethods-token"),!e(o.currentTarget).closest(t).find("#"+woo_ignite_cc_obj.id+"_widget"+woo_ignite_cc_obj.tokenId+"."+woo_ignite_cc_obj.id+"widget_class").length){e(".wc_payment_method.payment_method_"+woo_ignite_cc_obj.id+" [data-css-class$='widget_class']").each((function(){e(this).remove()}));const i='<div id="'+woo_ignite_cc_obj.id+"_widget"+woo_ignite_cc_obj.tokenId+'" class="'+woo_ignite_cc_obj.id+'widget_class" data-css-class="'+woo_ignite_cc_obj.id+'widget_class"></div>';e(o.currentTarget).closest(t).append(i),this.ajax_call(woo_ignite_cc_obj)}}},t.prototype.bind_click_place_order_event_handler=function(e){this.selected_gateway()===woo_ignite_cc_obj.id&&(e.preventDefault(),this.ignite_widget.submit())},t.prototype.bind_payment_method_selected_event_handler=function(o){e("#place_order").show(),this.bind_update_checkout_event_handler(),this.selected_gateway()===woo_ignite_cc_obj.id&&(e("input[id^=wc-"+woo_ignite_cc_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput").length<=1?(this.ajax_call(woo_ignite_cc_obj),null!=o&&o.stopImmediatePropagation()):null!=o&&(e("input[id^=wc-"+woo_ignite_cc_obj.id+"-payment-token-].woocommerce-SavedPaymentMethods-tokenInput:checked").trigger("change"),o.stopImmediatePropagation()))},t.prototype.bind_success_ajax_handler=function(o){try{if((o=JSON.parse(o)).token){const i=this.ignite_obj_creation(o.token),_=new window.IgnitePayment(i);if(""===woo_ignite_cc_obj.tokenId){e("#"+woo_ignite_cc_obj.id+"_token").remove();let t="";t="0"!==woo_ignite_cc_obj.admin_checkout_order_id?"#order_review":"form.checkout",e("<input>").attr({type:"hidden",id:woo_ignite_cc_obj.id+"_token",name:woo_ignite_cc_obj.id+"_token",value:o.token}).appendTo(t),_.setStyle({height:"470px",width:"75%"}),e("#"+woo_ignite_cc_obj.id+"_widget").html(""),_.render(woo_ignite_cc_obj.id+"_widget")}else _.setStyle({height:"270px",width:"75%"}),e("#"+woo_ignite_cc_obj.id+"_widget"+woo_ignite_cc_obj.tokenId).html(""),_.render(woo_ignite_cc_obj.id+"_widget"+woo_ignite_cc_obj.tokenId);const n=this.message_events();_.messageEventHandler(n),t.prototype.ignite_widget=_}else this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}catch(e){this.error_handler(wp.i18n.__("Initialize service not available","woocommerce"))}},t.prototype.error_handler=function(o){e("#"+woo_ignite_cc_obj.id+"_error").remove(),""===woo_ignite_cc_obj.tokenId?e("#"+woo_ignite_cc_obj.id+"_widget").prepend('<div class="woocommerce-error" id="'+woo_ignite_cc_obj.id+'_error">'+o+"</div>"):e("#"+woo_ignite_cc_obj.id+"_widget"+woo_ignite_cc_obj.tokenId).prepend('<div class="woocommerce-error" id="'+woo_ignite_cc_obj.id+'_error">'+o+"</div>")},t.prototype.ignite_obj_creation=function(e){return{clientID:woo_ignite_cc_obj.key,clientKey:woo_ignite_cc_obj.publishable_key,tokenize:!0,tokenId:e,showSavedCardOption:"1"===woo_ignite_cc_obj.show_saved_card_option&&""===woo_ignite_cc_obj.tokenId}},t.prototype.message_events=function(){return{onSubmit:()=>{},onSuccess:async o=>{if(woo_ignite_cc_obj.id===this.selected_gateway()){let t="";t="0"!==woo_ignite_cc_obj.admin_checkout_order_id?"#order_review":"form.checkout",""!==woo_ignite_cc_obj.tokenId&&o.token&&(e("#"+woo_ignite_cc_obj.id+"_token").remove(),e("<input>").attr({type:"hidden",id:woo_ignite_cc_obj.id+"_token",name:woo_ignite_cc_obj.id+"_token",value:o.token}).appendTo(t)),e(t).submit()}},onFailure:async()=>{}}},e(document).ready((function(){new t}))}(jQuery,window.ignite);